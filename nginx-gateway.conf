events {
    worker_connections 1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    server {
        listen 80;

        # Frontend - Raíz
        location / {
            proxy_pass http://petcare-frontend:80;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        # Auth Service
        location /api/Auth {
            proxy_pass http://petcare-auth:8080/api/Auth;
            proxy_set_header Host $host;
        }

        # Cliente Service
        location /api/cliente {
            proxy_pass http://petcare-cliente:8080/api/cliente;
            proxy_set_header Host $host;
        }

        # Cuidador Service
        location /api/cuidador {
            proxy_pass http://petcare-cuidador:8080/api/cuidador;
            proxy_set_header Host $host;
        }

        # Payment Service
        location /api/Payment {
            proxy_pass http://petcare-payment:8080/api/Payment;
            proxy_set_header Host $host;
        }

        # Calificar Service
        location /api/ratings {
            proxy_pass http://petcare-calificar:8080/api/ratings;
            proxy_set_header Host $host;
        }

        # Request Service (Genérico para las solicitudes)
        # Nota: Ajustamos para capturar cualquier otra cosa bajo /api si es necesario, 
        # pero según el .env antiguo apuntaba a http://...:5050/api
        location /api {
            proxy_pass http://petcare-request:8080/api;
            proxy_set_header Host $host;
        }
    }
}
