@Payment_Host = http://localhost:5012
@Auth_Host = http://localhost:5043

# ==========================================
# 1. INICIAR SESIÓN (Para obtener el Token)
# ==========================================
# Ajusta el email/password a uno que tengas registrado en tu BD.
# Si no tienes, usa el endpoint de registro en Auth primero.
POST {{Auth_Host}}/api/auth/login
Content-Type: application/json

{
  "email": "Raquel@example.com",
  "password": "Gato2010"
}

### Guardar el token en una variable (VS Code REST Client lo hace automático si usas la respuesta anterior)
# Copia el token de la respuesta de arriba si no usas la extensión REST Client completa
@authToken =eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1laWRlbnRpZmllciI6IjYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9lbWFpbGFkZHJlc3MiOiJSYXF1ZWxAZXhhbXBsZS5jb20iLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoiUmFxdWVsIEFyZXF1aXBhIiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbW9iaWxlcGhvbmUiOiIwOTc3ODc4NSIsImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvcm9sZSI6IkNsaWVudGUiLCJleHAiOjE3Njg3NjUyMDIsImlzcyI6IlBldENhcmUuQXV0aCIsImF1ZCI6IlBldENhcmUuQ2xpZW50In0.Fzf_MOi2Z1H1L4ZOtKRG3ICgapwU7SgXs2DLDcfgm-o


# ==========================================
# 2. PROBAR PAYPAL (Crear Orden)
# ==========================================
# Nota: Esto fallará si no has puesto tus ClientId/Secret de PayPal en el código/appsettings
# y PayPal devuelve 401 Unauthorized.
POST {{Payment_Host}}/api/payment/create-order
Content-Type: application/json

{
  "amount": 50.00,
  "currency": "USD",
  "description": "Servicio de paseo - 1 hora",
  "returnUrl": "http://localhost:3000/pago-exitoso",
  "cancelUrl": "http://localhost:3000/pago-cancelado"
}


# ==========================================
# 3. GUARDAR TARJETA (Encriptada)
# ==========================================
# Requiere Token. 
POST {{Payment_Host}}/api/payment/cards
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "cardNumber": "4111222233334444",
  "cardHolderName": "Usuario de Prueba",
  "expirationDate": "12/30",
  "cvv": "123" 
  // El CVV se envía pero NO se guarda en BD por seguridad
}


# ==========================================
# 4. VER MIS TARJETAS
# ==========================================
# Deberías ver solo los últimos 4 dígitos.
GET {{Payment_Host}}/api/payment/cards
Authorization: Bearer {{authToken}}
